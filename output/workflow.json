{
  "name": "Workflow test",
  "nodes": [
    {
      "id": "8d218d7f-f0dc-4302-a32e-0abfc9e446f6",
      "name": "Schedule Trigger 1",
      "type": "n8n-nodes-base.scheduleTrigger",
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "Weeks",
              "weeksInterval": 1,
              "triggerAtDay": [
                0
              ],
              "triggerAtHour": 21
            }
          ]
        }
      },
      "position": [
        0,
        0
      ]
    },
    {
      "id": "db3aa8d3-a369-40cc-9428-ec2e7be637b3",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "parameters": {
        "promptType": "define",
        "text": "=Today is: {{ $json['Readable date'] }}\r\n\r\n# Weekly FIRE Progress Report Generator\r\nYou are a FIRE (Financial Independence, Retire Early) progress analyzer. Generate a detailed weekly HTML email report with specific insights from the actual financial data provided.\r\n\r\n## Tools required:\r\n- get-accounts: Get account information and current net worth\r\n- spending-by-category: Count exact transactions, identify spending patterns, find largest expenses, map each category to FIRE categories for precise percentages over the last week\r\n- balance-history: Calculate monthly balance changes and trends over the last couple of months\r\n- monthly-summary: See monthly trends, category breakdown, savings rate over the last couple of months\r\n\r\n## Detailed Analysis Requirements:\r\n1. Weekly FIRE Score (1-10): Based on actual savings rate, spending discipline\r\n2. Net Worth Snapshot: Show exact balance changes, calculate implied savings rate, FIRE timeline impact\r\n3. Monthly Savings Rate Trend\r\n4. Precise Category Breakdown: Calculate exact dollar amounts and percentages for each FIRE category from spending categories\r\n5. Analysis and Recommendations: Identify actual spending patterns, concerning trends, evaluate how closely the FIRE method is being followed\r\n\r\n## FIRE Categories Analysis:\r\n- Wealth Building: Mortgage payments, investments, savings contributions (GREEN)\r\n- Essential: Food, utilities (like power, water, internet), transportation, medical costs, insurance (YELLOW)\r\n- Discretionary: Entertainment, dining out, shopping, subscriptions (RED if >15% of expenses)\r\n\r\n## Output Requirements:\r\n- HTML format suitable for email (inline CSS only)\r\n- **CRITICAL: Output clean HTML without any escape characters like \\n, \\t, or \\\" - the HTML should be ready to use directly in an email**\r\n- Include specific dollar amounts, percentages, and transaction counts from the data\r\n- Mobile-friendly design with clear sections\r\n- Style using Bootstrap 5 with card components, using success (green), warning (yellow), and danger (red) contextual colors for the different FIRE categories.\r\n- No DOCTYPE, comments, or text outside HTML tags\r\n- Start directly with HTML content\r\n- **Do not include any line breaks or escape sequences in the output**\r\n\r\n## Tone Requirements:\r\n- Use actual data points in analysis\r\n- Provide specific actionable insights based on real patterns observed\r\n- Be encouraging but honest about areas needing improvement\r\n- Include specific recommendations based on the actual spending behavior shown\r\nAnalyze the provided MCP data thoroughly and generate detailed HTML with specific insights from the actual financial spending and account information.\r\n\r\n\r\nUse this example html file to base your report on, follow its style and structure very closely:\r\n<html>\r\n<head>\r\n<title>Your Weekly FIRE Progress Report</title>\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n<style>\r\nbody {\r\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif;\r\n  line-height: 1.5;\r\n  color: #212529;\r\n  margin: 0;\r\n  padding: 20px;\r\n  background-color: #f8f9fa;\r\n}\r\n.container {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  background-color: #fff;\r\n  border-radius: 5px;\r\n  box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);\r\n  overflow: hidden;\r\n}\r\n.header {\r\n  background-color: #343a40;\r\n  color: white;\r\n  padding: 20px;\r\n  text-align: center;\r\n}\r\n.section {\r\n  padding: 20px;\r\n  border-bottom: 1px solid #dee2e6;\r\n}\r\n.card {\r\n  border: 1px solid rgba(0,0,0,.125);\r\n  border-radius: 0.25rem;\r\n  margin-bottom: 20px;\r\n}\r\n.card-header {\r\n  padding: 0.75rem 1.25rem;\r\n  background-color: rgba(0,0,0,.03);\r\n  border-bottom: 1px solid rgba(0,0,0,.125);\r\n  font-weight: bold;\r\n}\r\n.card-body {\r\n  padding: 1.25rem;\r\n}\r\n.progress {\r\n  height: 20px;\r\n  background-color: #e9ecef;\r\n  border-radius: 0.25rem;\r\n  margin-bottom: 1rem;\r\n  display: flex;\r\n  overflow: hidden;\r\n}\r\n.progress-bar {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  color: #fff;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  transition: width 0.6s ease;\r\n}\r\n.progress-bar-success {\r\n  background-color: #28a745;\r\n}\r\n.progress-bar-warning {\r\n  background-color: #ffc107;\r\n}\r\n.progress-bar-danger {\r\n  background-color: #dc3545;\r\n}\r\n.badge {\r\n  display: inline-block;\r\n  padding: 0.25em 0.4em;\r\n  font-size: 75%;\r\n  font-weight: 700;\r\n  line-height: 1;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  vertical-align: baseline;\r\n  border-radius: 0.25rem;\r\n  margin-left: 5px;\r\n}\r\n.badge-success {\r\n  background-color: #28a745;\r\n  color: white;\r\n}\r\n.badge-warning {\r\n  background-color: #ffc107;\r\n  color: #212529;\r\n}\r\n.badge-danger {\r\n  background-color: #dc3545;\r\n  color: white;\r\n}\r\n.table {\r\n  width: 100%;\r\n  margin-bottom: 1rem;\r\n  color: #212529;\r\n  border-collapse: collapse;\r\n}\r\n.table th, .table td {\r\n  padding: 0.75rem;\r\n  vertical-align: top;\r\n  border-top: 1px solid #dee2e6;\r\n  text-align: left;\r\n}\r\n.table thead th {\r\n  vertical-align: bottom;\r\n  border-bottom: 2px solid #dee2e6;\r\n}\r\n.score-container {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n.score-circle {\r\n  width: 100px;\r\n  height: 100px;\r\n  border-radius: 50%;\r\n  background-color: #f8f9fa;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 2.5rem;\r\n  font-weight: bold;\r\n  border: 5px solid;\r\n}\r\n.score-8 {\r\n  border-color: #28a745;\r\n  color: #28a745;\r\n}\r\n.alert {\r\n  position: relative;\r\n  padding: 0.75rem 1.25rem;\r\n  margin-bottom: 1rem;\r\n  border: 1px solid transparent;\r\n  border-radius: 0.25rem;\r\n}\r\n.alert-warning {\r\n  color: #856404;\r\n  background-color: #fff3cd;\r\n  border-color: #ffeeba;\r\n}\r\n.alert-success {\r\n  color: #155724;\r\n  background-color: #d4edda;\r\n  border-color: #c3e6cb;\r\n}\r\n.text-success { color: #28a745; }\r\n.text-danger { color: #dc3545; }\r\n.text-warning { color: #ffc107; }\r\n</style>\r\n</head>\r\n<body>\r\n<div class=\"container\">\r\n  <div class=\"header\">\r\n    <h1>Weekly FIRE Progress Report</h1>\r\n    <p>July 8 - July 15, 2025</p>\r\n  </div>\r\n  \r\n  <div class=\"section\">\r\n    <div class=\"score-container\">\r\n      <div class=\"score-circle score-8\">8</div>\r\n      <h2>Your FIRE Progress Score</h2>\r\n    </div>\r\n    \r\n    <div class=\"alert alert-success\">\r\n      <strong>Positive Trend:</strong> Your savings rate of 37.6% this month shows good progress toward financial independence.\r\n    </div>\r\n    \r\n    <p>Based on your actual spending and savings behaviors this week, you're making solid progress toward your FIRE goals. Your high historical savings rate demonstrates financial discipline, though there's a concerning downward trend in your savings rate from previous months.</p>\r\n  </div>\r\n  \r\n  <div class=\"section\">\r\n    <h2>Net Worth Snapshot</h2>\r\n    \r\n    <div class=\"card\">\r\n      <div class=\"card-header\">Current Net Worth: $62,356.41</div>\r\n      <div class=\"card-body\">\r\n        <table class=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Account</th>\r\n              <th>Balance</th>\r\n              <th>Monthly Change</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>Bank of America</td>\r\n              <td>$4,564.93</td>\r\n              <td><span class=\"text-success\">↑ $4,884.82</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Ally Savings</td>\r\n              <td>$3,770.71</td>\r\n              <td><span class=\"text-success\">↑ $334.84</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Capital One Checking</td>\r\n              <td>$1,089.81</td>\r\n              <td><span class=\"text-success\">↑ $193.20</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>HSBC</td>\r\n              <td>$1,277.55</td>\r\n              <td><span class=\"text-success\">↑ $624.43</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Vanguard 401k</td>\r\n              <td>$1,632.24</td>\r\n              <td>$0.00</td>\r\n            </tr>\r\n            <tr>\r\n              <td>Roth IRA</td>\r\n              <td>$3,094.30</td>\r\n              <td><span class=\"text-success\">↑ $443.13</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>House Asset</td>\r\n              <td>$356,700.00</td>\r\n              <td><span class=\"text-success\">↑ $900.00</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Mortgage</td>\r\n              <td>-$309,773.13</td>\r\n              <td><span class=\"text-success\">↑ $1,447.43</span></td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        \r\n        <div class=\"alert alert-warning\">\r\n          <strong>Savings Rate Trend:</strong> Your savings rate has declined from 86.9% in May to 37.6% in July.\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <p><strong>FIRE Timeline Impact:</strong> Based on your current average savings rate of 60.5% and assuming a 4% withdrawal rate, you're on track for financial independence in approximately 12 years. However, if the July trend (37.6%) continues, this timeline would extend to about 22 years.</p>\r\n  </div>\r\n  \r\n  <div class=\"section\">\r\n    <h2>Weekly Spending Analysis</h2>\r\n    \r\n    <div class=\"card\">\r\n      <div class=\"card-header\">Total Spending: $531.42</div>\r\n      <div class=\"card-body\">\r\n        <h4>FIRE Category Breakdown</h4>\r\n        \r\n        <div class=\"progress\">\r\n          <div class=\"progress-bar progress-bar-success\" style=\"width: 0%;\" title=\"Wealth Building\">0%</div>\r\n          <div class=\"progress-bar progress-bar-warning\" style=\"width: 58.5%;\" title=\"Essential\">58.5%</div>\r\n          <div class=\"progress-bar progress-bar-danger\" style=\"width: 41.5%;\" title=\"Discretionary\">41.5%</div>\r\n        </div>\r\n        \r\n        <table class=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th>FIRE Category</th>\r\n              <th>Amount</th>\r\n              <th>Percentage</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>Wealth Building <span class=\"badge badge-success\">GREEN</span></td>\r\n              <td>$0.00</td>\r\n              <td>0%</td>\r\n            </tr>\r\n            <tr>\r\n              <td>Essential <span class=\"badge badge-warning\">YELLOW</span></td>\r\n              <td>$310.55</td>\r\n              <td>58.5%</td>\r\n            </tr>\r\n            <tr>\r\n              <td>Discretionary <span class=\"badge badge-danger\">RED</span></td>\r\n              <td>$220.87</td>\r\n              <td>41.5%</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        \r\n        <h4>Detailed Spending</h4>\r\n        <table class=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Category</th>\r\n              <th>Amount</th>\r\n              <th>Transactions</th>\r\n              <th>FIRE Type</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>Entertainment</td>\r\n              <td>$107.30</td>\r\n              <td>5</td>\r\n              <td><span class=\"badge badge-danger\">Discretionary</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>General</td>\r\n              <td>$101.02</td>\r\n              <td>4</td>\r\n              <td><span class=\"badge badge-danger\">Discretionary</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Clothing</td>\r\n              <td>$100.51</td>\r\n              <td>5</td>\r\n              <td><span class=\"badge badge-warning\">Essential</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Food</td>\r\n              <td>$100.23</td>\r\n              <td>2</td>\r\n              <td><span class=\"badge badge-warning\">Essential</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Power</td>\r\n              <td>$100.00</td>\r\n              <td>1</td>\r\n              <td><span class=\"badge badge-warning\">Essential</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Restaurants</td>\r\n              <td>$13.05</td>\r\n              <td>5</td>\r\n              <td><span class=\"badge badge-danger\">Discretionary</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Medical</td>\r\n              <td>$6.32</td>\r\n              <td>1</td>\r\n              <td><span class=\"badge badge-warning\">Essential</span></td>\r\n            </tr>\r\n            <tr>\r\n              <td>Gift</td>\r\n              <td>$2.99</td>\r\n              <td>1</td>\r\n              <td><span class=\"badge badge-danger\">Discretionary</span></td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  \r\n  <div class=\"section\">\r\n    <h2>Analysis & Recommendations</h2>\r\n    \r\n    <div class=\"card\">\r\n      <div class=\"card-header\">Key Insights</div>\r\n      <div class=\"card-body\">\r\n        <ul>\r\n          <li><strong>Discretionary Spending Alert:</strong> At 41.5% of your total expenses, your discretionary spending is significantly above the recommended 15% threshold for optimal FIRE progress.</li>\r\n          <li><strong>No Wealth Building:</strong> You had no wealth building transactions this week, which slows progress toward financial independence.</li>\r\n          <li><strong>Entertainment Habits:</strong> You had 5 entertainment transactions totaling $107.30, making this your largest discretionary spending category.</li>\r\n          <li><strong>Frequent Small Purchases:</strong> You made 5 restaurant transactions but only spent $13.05 total, showing good control in this area.</li>\r\n        </ul>\r\n        \r\n        <h4>Specific Recommendations</h4>\r\n        <ol>\r\n          <li>Reduce entertainment spending by at least 50% next week to bring discretionary expenses closer to the 15% target.</li>\r\n          <li>Review the 4 \"General\" category transactions totaling $101.02 to identify potential unnecessary expenses.</li>\r\n          <li>Consider if the 5 clothing transactions ($100.51) were all essential or if some could be classified as discretionary shopping.</li>\r\n          <li>Increase contributions to your investment accounts, as there were no investment transactions recorded this period.</li>\r\n          <li>Maintain your positive housing equity growth trend ($900 monthly increase in house value while reducing mortgage by $1,447.43).</li>\r\n        </ol>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  \r\n  <div class=\"section\">\r\n    <h2>Monthly Savings Rate Trend</h2>\r\n    \r\n    <div class=\"card\">\r\n      <div class=\"card-body\">\r\n        <div class=\"progress\" style=\"height: 30px; margin-bottom: 10px;\">\r\n          <div class=\"progress-bar progress-bar-success\" style=\"width: 86.9%;\" title=\"May 2025\">May: 86.9%</div>\r\n        </div>\r\n        <div class=\"progress\" style=\"height: 30px; margin-bottom: 10px;\">\r\n          <div class=\"progress-bar progress-bar-success\" style=\"width: 62.8%;\" title=\"June 2025\">June: 62.8%</div>\r\n        </div>\r\n        <div class=\"progress\" style=\"height: 30px; margin-bottom: 10px;\">\r\n          <div class=\"progress-bar progress-bar-warning\" style=\"width: 37.6%;\" title=\"July 2025\">July: 37.6%</div>\r\n        </div>\r\n        \r\n        <p>Your overall average savings rate of 60.5% is excellent for FIRE purposes, but the downward trend requires attention. If you can maintain a savings rate above 50%, you'll stay on track for your financial independence goals.</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  \r\n  <div class=\"section\" style=\"border-bottom: none;\">\r\n    <h3>Next Steps</h3>\r\n    <p>Focus on reducing discretionary spending to under 15% of total expenses while maintaining your essential expenses under 50%. Consider setting up automated transfers to your investment accounts to increase wealth building allocation.</p>\r\n    \r\n    <p>Your FIRE journey is making good progress despite the recent trend. With some adjustments to your spending habits, you can get back on the accelerated path to financial independence.</p>\r\n  </div>\r\n</div>\r\n</body>\r\n</html>"
      },
      "position": [
        0,
        0
      ]
    },
    {
      "id": "160249a1-5465-47af-8be9-efc8d4dc3f78",
      "name": "OpenRouter Chat Model 1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "parameters": {
        "model": "=anthropic/claude-3.7-sonnet"
      },
      "position": [
        0,
        0
      ],
      "credentials": {
        "openRouterApi": {
          "id": "nN8UkME96wTEJUsX",
          "name": "OpenRouter my"
        }
      }
    },
    {
      "id": "d32d2782-3ae0-4944-8fe1-dfae59d7bbd1",
      "name": "MCP Client 1",
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "parameters": {
        "sseEndpoint": "https://duck-fleet-sturgeon.ngrok-free.app/sse"
      },
      "position": [
        0,
        0
      ]
    },
    {
      "id": "2460c6c2-e2ef-4c03-95db-9126024ec3cf",
      "name": "Resend",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "method": "POST",
        "url": "https://api.resend.com/emails",
        "authentication": "genericCredentialType",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "from",
              "value": "onboarding@resend.dev"
            },
            {
              "name": "to",
              "value": "adomas.reginis@gmail.com"
            },
            {
              "name": "subject",
              "value": "Weekly Budget Report"
            },
            {
              "name": "html",
              "value": "={{ $json.output }}"
            }
          ]
        },
        "nodeCredentialType": false,
        "genericAuthType": "httpBearerAuth"
      },
      "position": [
        0,
        0
      ],
      "credentials": {
        "httpBearerAuth": {
          "id": "GyoOmDhEai7HY25I",
          "name": "Resend my"
        }
      }
    }
  ],
  "connections": {
    "Schedule Trigger 1": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Resend",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model 1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "MCP Client 1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Resend": {}
  },
  "settings": {}
}